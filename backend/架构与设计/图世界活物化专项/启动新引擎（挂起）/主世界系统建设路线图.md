# ä¸»ä¸–ç•Œç³»ç»Ÿå»ºè®¾è·¯çº¿å›¾

> åˆ›å»ºæ—¶é—´ï¼š2026-02-20
> å‰èº«ï¼šã€Œæ–°å¼•æ“ä¸Šçº¿ä¸ä»»åŠ¡æ± ç³»ç»Ÿ.mdã€â†’ã€Œæ–°ç³»ç»Ÿä¸Šçº¿é˜»å¡é—®é¢˜æ¸…å•.mdã€
> çŠ¶æ€ï¼šPart A å·²å®Œæˆï¼Œ**Part B-G å…¨éƒ¨æŒ‚èµ·** â€” ç­‰å¾…æ¶æ„é‡æ„å®Œæˆåé‡æ–°è§„åˆ’
> èŒƒå›´ï¼šå¼•æ“å µç‚¹ä¿®å¤ + å‰ç«¯é€‚é… + å•†åº—äº¤æ˜“ + ç‰©å“ç»æµ + è§’è‰²æˆé•¿ + æ—¶é—´æœºæ¢°åŒ– + ä»»åŠ¡æ± ä¸»çº¿
> ä¸å«ï¼šæˆ˜æ–—ç³»ç»Ÿï¼ˆç‹¬ç«‹æ–‡æ¡£ï¼š`ä¸–ç•Œåº•å±‚é‡æ„ä¸æˆ˜æ–—ç³»ç»Ÿè®¾è®¡ä¸“é¡¹/æˆ˜æ–—ç³»ç»Ÿé‡æ„è®¡åˆ’.md`ï¼‰
>
> **âš ï¸ 2026-02-20 æŒ‚èµ·è¯´æ˜**ï¼šPart B-G çš„å…·ä½“å®æ–½æ–¹æ¡ˆåœ¨æ¶æ„é‡æ„å‰æš‚ä¸æ‰§è¡Œã€‚
> é‡æ„æ–¹å‘ï¼šå°†æ¸¸æˆä¸–ç•Œç³»ç»Ÿæ•´ä½“åŒ…è£…ä¸ºç»Ÿä¸€ MCP æœåŠ¡ï¼Œä¸Šå±‚æŠ½è±¡æœåŠ¡å±‚éš”ç¦» Agent/ç©å®¶ä¸åº•å±‚æœºæ¢°ç»“æ„ã€‚
> è¯¦è§ï¼š`æ¶æ„é‡æ„è®¡åˆ’.md`ï¼ˆå¾…åˆ›å»ºï¼‰

---

## ä¸€ã€æ€»çº²

### 1.1 å½“å‰ä½ç½®

Direction A æ€»çº¿é©±åŠ¨æ¶æ„å·²å®Œæˆï¼ˆF01-F25ï¼Œ147 æµ‹è¯•é€šè¿‡ï¼‰ï¼Œå¼•æ“å µç‚¹å·²ä¿®å¤ï¼ˆA1-A4ï¼Œ222 æµ‹è¯•é€šè¿‡ï¼‰ã€‚

**å¼•æ“å·²é€šè·¯**ï¼šWorldGraph âœ…ã€SceneBus âœ…ã€å¼•æ“å‰ç½®æ‰§è¡Œ âœ…ã€å­åœ°ç‚¹é”šå®š âœ…ã€NPC HOSTS ç²¾ç¡® âœ…ã€ç©ºé˜Ÿä¼è‡ªåŠ¨åˆ›å»º âœ…

**ä½†ä¸–ç•Œè¿˜æ˜¯ç©ºå£³**â€”â€”ç©å®¶èƒ½èµ°èƒ½çœ‹ï¼Œå´ä¸èƒ½ä¹°å–ã€ä¸èƒ½å‡çº§ã€ä¸èƒ½æ¥ä»»åŠ¡ã€é‡‘å¸æœ‰è¿›æ— å‡ºã€‚ä»¥ä¸‹æ˜¯éœ€è¦å»ºè®¾çš„ä¸–ç•Œç³»ç»Ÿæ¸…å•ã€‚

### 1.2 ç³»ç»Ÿæˆç†Ÿåº¦çŸ©é˜µ

| ç³»ç»Ÿ | å®Œæˆåº¦ | å·²æœ‰åŸºç¡€ | å…³é”®ç¼ºå£ |
|------|--------|----------|----------|
| å¼•æ“é€šè·¯ | âœ… 100% | Part A å…¨éƒ¨å®Œæˆ | â€” |
| å‰ç«¯å¼•æ“é€‚é… | ğŸ”² 0% | æ•°æ®å·²å°±ç»ªï¼ˆNPC ä½ç½®/å­åœ°ç‚¹ï¼‰ | æ—  API ç«¯ç‚¹ã€æ—  UI |
| å•†åº— & äº¤æ˜“ | ğŸ”² ~30% | å•†åº—å­åœ°ç‚¹ã€è¥ä¸šæ—¶é—´ã€å•†äºº NPCã€ç‰©å“ä»·æ ¼ | æ— ä¹°å–æœºåˆ¶ã€æ—  NPC åº“å­˜ |
| ç‰©å“ç³»ç»Ÿ | â¬œ ~70% | èƒŒåŒ…æ¨¡å‹ã€è£…å¤‡æ§½ã€ItemRegistry(200+)ã€MCP å·¥å…· | ç‰©å“æ•ˆæœä»…æ²»ç–—è¯æ°´ã€æ— å‰ç«¯ API |
| ç»æµå¾ªç¯ | ğŸ”² ~30% | é‡‘å¸å­—æ®µã€æˆ˜æ–—/äº‹ä»¶å¥–åŠ± | é‡‘å¸åªè¿›ä¸å‡ºã€æ— æ¶ˆè´¹åœºæ™¯ |
| è§’è‰²æˆé•¿ | â¬œ ~50% | XP è¿½è¸ªã€ç­‰çº§å­—æ®µã€ç†Ÿç»ƒåº¦ | æ— å‡çº§æœºåˆ¶ã€æ— ä¸“é•¿æ•ˆæœ |
| æ—¶é—´ç³»ç»Ÿ | â¬œ ~60% | TimeManagerã€æ—¶æ®µ/è¥ä¸šæ—¶é—´ã€NPC æ´»åŠ¨è¡¨ | æ—¶é—´ç”± LLM æ‰‹åŠ¨æ¨è¿› |
| ä»»åŠ¡æ± ä¸»çº¿ | ğŸ”² ~5% | æ¦‚å¿µè®¾è®¡å®Œæˆ | å…¨éƒ¨å¾…å®ç° |

> å›¾ä¾‹ï¼šâœ… å®Œæˆ | â¬œ æœ‰åŸºç¡€å¾…æ‰©å±• | ğŸ”² åŸºç¡€è®¾æ–½å°±ç»ªå¾…å»ºè®¾

### 1.3 æ¶æ„å†³ç­–

| # | å†³ç­– | è¯´æ˜ |
|---|------|------|
| AD6 | NPC æ˜¯ä»»åŠ¡æº | NPC Agent å›´ç»•ä¸»çº¿ä¸Šä¸‹æ–‡è‡ªä¸»ç¼–çº‚å‘å¸ƒä»»åŠ¡ |
| AD7 | ä¸»çº¿ = å®Œæˆåº¦æ±  | ä¸»çº¿ä¸æ˜¯çº¿æ€§äº‹ä»¶é“¾ï¼Œæ˜¯é‡åŒ–çš„å®Œæˆåº¦æŒ‡æ ‡ |
| AD8 | å‰ç«¯ç›´å‘ NPC äº¤äº’ | ç‚¹å‡» NPC â†’ NPC Agent ç›´æ¥å›å¤ï¼ˆä¸ç» GM ä»£è¨€ï¼‰ |
| AD9 | å•†åº— = NPC å¯¹è¯çš„ç‰¹æ®Šæ¨¡å¼ | ä¹°å–æ˜¯ NPC äº¤äº’çš„å­é›†ï¼Œä¸æ˜¯ç‹¬ç«‹ç³»ç»Ÿ |
| AD10 | æ—¶é—´ = å¼•æ“æœºæ¢°å±‚ | æ—¶é—´éšç©å®¶æ“ä½œè‡ªåŠ¨æµé€ï¼ŒLLM ä»…æ§åˆ¶æ˜¾å¼ä¼‘æ¯ |
| AD11 | å‡çº§ = å¼•æ“è‡ªåŠ¨è§¦å‘ | XP è¾¾æ ‡æ—¶å¼•æ“æœºæ¢°å‡çº§ï¼ŒLLM å™è¿°å‡çº§åœºæ™¯ |

### 1.4 ä¸æˆ˜æ–—ç³»ç»Ÿçš„è¾¹ç•Œ

æˆ˜æ–—ç³»ç»Ÿç‹¬ç«‹é‡æ„ï¼ˆè§ `æˆ˜æ–—ç³»ç»Ÿé‡æ„è®¡åˆ’.md`ï¼‰ï¼Œæœ¬æ–‡ä¸æ¶‰åŠã€‚ä½†æœ‰æ¥å£çº¦å®šï¼š

| æ¥å£ | æ–¹å‘ | è¯´æ˜ |
|------|------|------|
| æˆ˜æ–—æ‰è½ â†’ èƒŒåŒ… | æˆ˜æ–— â†’ æœ¬æ–‡ | æˆ˜æ–—ç»“ç®—çš„ `items` é€šè¿‡ `add_item()` å†™å…¥èƒŒåŒ… |
| èƒŒåŒ…ç‰©å“ â†’ æˆ˜æ–—ä½¿ç”¨ | æœ¬æ–‡ â†’ æˆ˜æ–— | æˆ˜æ–—å¯åŠ¨æ—¶æ³¨å…¥ `player_inventory` åˆ° environment |
| å‡çº§å±æ€§ â†’ æˆ˜æ–—æ•°å€¼ | æœ¬æ–‡ â†’ æˆ˜æ–— | `PlayerCharacter` å‡çº§å `to_combat_player_state()` è‡ªåŠ¨åæ˜  |
| å•†åº—è´­ä¹° â†’ è£…å¤‡ â†’ AC/æ”»å‡» | æœ¬æ–‡ â†’ æˆ˜æ–— | è£…å¤‡å˜æ›´é€šè¿‡ `_recalculate_ac()` å½±å“æˆ˜æ–—æ•°å€¼ |

---

## äºŒã€Part A â€” å¼•æ“å µç‚¹ä¿®å¤ âœ… å·²å®Œæˆ

> 2026-02-20 å®Œæˆï¼Œ222 æµ‹è¯•é€šè¿‡æ— å›å½’ã€‚è¯¦è§å˜æ›´æ—¥å¿—ã€‚

| # | ä¿®å¤ | æ–‡ä»¶ |
|---|------|------|
| A1 | `start_session()` è‡ªåŠ¨é€‰æ‹©èµ·å§‹å­åœ°ç‚¹ | `world_runtime.py` |
| A2 | `GraphBuilder` ä» `resident_npcs` åˆ›å»ºå­åœ°ç‚¹çº§ HOSTS è¾¹ | `graph_builder.py` |
| A3 | Party ç©ºé˜Ÿä¼è‡ªåŠ¨åˆ›å»ºï¼ˆé˜Ÿå‹é€šè¿‡æ¸¸æˆå†…é‚€è¯·åŠ å…¥ï¼‰ | `admin_coordinator.py` |
| A4 | é™çº§æ—¥å¿—å¯è§åŒ– + `degradation_info` å±æ€§ | `session_runtime.py`, `pipeline_orchestrator.py` |

---

## ä¸‰ã€Part B â€” å‰ç«¯å¼•æ“é€‚é… â¸ï¸ æŒ‚èµ·

### B1: NPC åˆ—è¡¨å±•ç¤º

**ç°æœ‰åŸºç¡€**: A2 ä¿®å¤å `WorldGraph` æœ‰ç²¾ç¡®çš„å­åœ°ç‚¹çº§ HOSTS è¾¹
**æ•°æ®æº**: `WorldInstance.get_characters_at_sublocation(area_id, sub_id)`

**éœ€è¦**:
- åç«¯ API ç«¯ç‚¹ï¼šè¿”å›å½“å‰å­åœ°ç‚¹çš„å¯äº¤äº’ NPC åˆ—è¡¨ï¼ˆnameã€tierã€occupationã€ç®€çŸ­æè¿°ï¼‰
- å‰ç«¯ï¼šLocationCard æˆ–ç‹¬ç«‹é¢æ¿å±•ç¤º NPC åˆ—è¡¨
- NPC çŠ¶æ€æŒ‡ç¤ºï¼ˆå¯äº¤äº’ / å¿™ç¢Œ / ä¸åœ¨åœºï¼‰

### B2: NPC ç›´æ¥äº¤äº’

**éœ€è¦**:
- ç‚¹å‡» NPC â†’ ç›´æ¥å‘èµ·å¯¹è¯ â†’ NPC Agent ç«‹åˆ»å›å¤ï¼ˆAD8ï¼‰
- ä¸ç»è¿‡ GM ä»£è¨€ï¼ŒNPC è‡ªä¸»å‘è¨€
- åç«¯ï¼šç‹¬ç«‹ç«¯ç‚¹æˆ–ç»“æ„åŒ–æŒ‡ä»¤ï¼Œç›´é€š NPC Agentï¼ˆè·³è¿‡ IntentResolver/GM agenticï¼‰
- å‰ç«¯ï¼šNPC å¯¹è¯æ°”æ³¡/é¢æ¿ï¼ŒåŒºåˆ†äº GM å™è¿°

### B3: å­åœ°ç‚¹åˆ‡æ¢ UI

**ç°æœ‰åŸºç¡€**: `IntentExecutor` å·²å¤„ç†å­åœ°ç‚¹åˆ‡æ¢ï¼ˆç¬¬ 3 è½®å®æµ‹éªŒè¯å¯ç”¨ï¼‰
**éœ€è¦**:
- å½“å‰å­åœ°ç‚¹å±•ç¤ºï¼ˆå·²æœ‰ `available_sub_locations` æ•°æ®ï¼‰
- åˆ‡æ¢å­åœ°ç‚¹ â†’ å¼•æ“å¤„ç† â†’ NPC åˆ—è¡¨æ›´æ–°

### B4: æ€»çº¿ä¿¡å·å¯è§†åŒ–ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

- SceneBus æ¡ç›®ä»¥æ—¶é—´çº¿å½¢å¼å±•ç¤º
- åŒºåˆ† actor ç±»å‹ï¼ˆplayer / NPC / é˜Ÿå‹ / å¼•æ“ / GMï¼‰

---

## å››ã€Part C â€” ä»»åŠ¡æ± é©±åŠ¨çš„ä¸»çº¿ç³»ç»Ÿ â¸ï¸ æŒ‚èµ·

> æœ€å¤§çš„æ¶æ„å˜æ›´ã€‚æ¦‚å¿µè®¾è®¡å®Œæˆï¼Œéœ€ç»†åŒ–åå®æ–½ã€‚

### C1: è®¾è®¡å“²å­¦

**å½“å‰çº¿æ€§ç³»ç»Ÿçš„é—®é¢˜**:
- 8 ä¸ªäº‹ä»¶æŒ‰é¡ºåºè§¦å‘ï¼Œåƒåœ¨èµ°å‰§æœ¬
- ç©å®¶è‡ªç”±åº¦å—é™ï¼šå¿…é¡»æŒ‰äº‹ä»¶é¡ºåºæ¨è¿›
- NPC æ˜¯è¢«åŠ¨çš„ï¼šç­‰äº‹ä»¶è§¦å‘æ‰æœ‰å°è¯
- GM è´Ÿæ‹…é‡ï¼šæ—¢è¦æ¨è¿›å‰§æƒ…åˆè¦å™è¿°
- åç¦»äº† Direction A "å‘ˆç°è€Œéæ¨è¿›" çš„åŸåˆ™

**ä»»åŠ¡æ± çš„æ ¸å¿ƒç†å¿µ**:
- ä¸»çº¿ä¸æ˜¯ä¸€æ¡çº¿ï¼Œæ˜¯ä¸€ä¸ª**åœº**
- NPC æ„ŸçŸ¥åˆ°ä¸»çº¿çš„"å‹åŠ›"ï¼Œè‡ªä¸»äº§å‡ºä»»åŠ¡
- ç©å®¶é€šè¿‡å®Œæˆä»»åŠ¡æ¨è¿›å®Œæˆåº¦ï¼Œ**é€‰å“ªäº›ä»»åŠ¡ã€ä»€ä¹ˆé¡ºåºï¼Œå®Œå…¨è‡ªç”±**
- è¾¾åˆ°é‡Œç¨‹ç¢‘é˜ˆå€¼ â†’ **å…³é”®å‰§æƒ…èŠ‚ç‚¹**è‡ªåŠ¨è§¦å‘
- GM åªè´Ÿè´£å‘ˆç°ä¸–ç•Œçš„å˜åŒ–å’Œæ°›å›´

### C2: æ¦‚å¿µæ¨¡å‹

```
StorylineArcï¼ˆä¸»çº¿å¼§ï¼‰
  â”œâ”€ id: "arc_goblin_crisis"
  â”œâ”€ name: "å“¥å¸ƒæ—å±æœº"
  â”œâ”€ description: "è¾¹å¢ƒå“¥å¸ƒæ—æ´»åŠ¨æ—¥ç›ŠçŒ–ç—..."
  â”œâ”€ completion: 0/100
  â”œâ”€ milestones:
  â”‚    â”œâ”€ 25%: "çº¿ç´¢æµ®ç°"  â†’ è§¦å‘å…³é”®å‰§æƒ…
  â”‚    â”œâ”€ 50%: "æ·±å…¥è°ƒæŸ¥"  â†’ è§¦å‘å…³é”®å‰§æƒ…
  â”‚    â”œâ”€ 75%: "å†³æˆ˜å‰å¤œ"  â†’ è§¦å‘å…³é”®å‰§æƒ…
  â”‚    â””â”€ 100%: "å±æœºè§£é™¤" â†’ è§¦å‘ç« èŠ‚è½¬æ¢
  â””â”€ context_tags: ["goblin", "frontier", "danger", "guild"]

Questï¼ˆä»»åŠ¡ï¼‰
  â”œâ”€ id: "quest_goblin_patrol_01"
  â”œâ”€ source_npc: "guild_girl"          â† å‘å¸ƒè€…
  â”œâ”€ arc_id: "arc_goblin_crisis"       â† æ‰€å±ä¸»çº¿å¼§
  â”œâ”€ completion_value: 15              â† å®Œæˆè´¡çŒ®
  â”œâ”€ description: "æœ€è¿‘è¥¿éƒ¨ç‰§åœºé­åˆ°å“¥å¸ƒæ—è¢­å‡»..."
  â”œâ”€ requirements: {min_level: 1}
  â”œâ”€ rewards: {gold: 50, xp: 100, items: ["healing_potion"]}
  â”œâ”€ status: available | accepted | completed | failed | expired
  â””â”€ generated_by: "npc_agent"         â† LLM ç”Ÿæˆæ ‡è®°
```

### C3: NPC ä½œä¸ºä»»åŠ¡æº

```
NPC Agent æ„ŸçŸ¥ï¼š
  1. å½“å‰ StorylineArc çš„ä¸Šä¸‹æ–‡ + å®Œæˆåº¦
  2. è‡ªå·±çš„è§’è‰²å®šä½ï¼ˆoccupation, personality, motivationï¼‰
  3. å½“å‰åŒºåŸŸçš„çŠ¶æ€ï¼ˆæ—¶é—´ã€æœ€è¿‘äº‹ä»¶ã€å…¶ä»–ä»»åŠ¡ï¼‰

NPC Agent è¾“å‡ºï¼š
  â†’ guild_girl å‘å¸ƒæ­£å¼å…¬å‘Šç±»ä»»åŠ¡
  â†’ goblin_slayer å‘å¸ƒé«˜éš¾åº¦æ¸…å·¢ä»»åŠ¡
  â†’ priestess å‘å¸ƒæŠ¤é€/æ²»ç–—ç±»ä»»åŠ¡

è§¦å‘æ—¶æœºï¼š
  â†’ ç©å®¶è¿›å…¥ NPC æ‰€åœ¨å­åœ°ç‚¹æ—¶
  â†’ å®šæœŸåˆ·æ–°ï¼ˆgame_time æ¨è¿›æ—¶ï¼‰
  â†’ ä¸»çº¿å®Œæˆåº¦å˜åŒ–æ—¶
```

### C4: ä¸ç°æœ‰ç³»ç»Ÿçš„å…³ç³»

| ç°æœ‰ç»„ä»¶ | å¤ç”¨ï¼Ÿ | å˜åŒ– |
|---------|--------|------|
| `chapters` | ä¿ç•™ï¼Œè¯­ä¹‰å˜åŒ– | ç« èŠ‚ = ä¸»çº¿å¼§çš„é˜¶æ®µ |
| `events` | ä¿ç•™ï¼Œé‡å®šä½ | äº‹ä»¶ = é‡Œç¨‹ç¢‘è§¦å‘çš„å…³é”®å‰§æƒ…èŠ‚ç‚¹ |
| `BehaviorEngine` | å®Œå…¨å¤ç”¨ | é‡Œç¨‹ç¢‘è¾¾æˆ â†’ è§¦å‘ ON_MILESTONE |
| `WorldGraph` | æ‰©å±• | æ–°å¢ QUEST èŠ‚ç‚¹ + OFFERS è¾¹ |
| `SceneBus` | å®Œå…¨å¤ç”¨ | ä»»åŠ¡å‘å¸ƒ/å®Œæˆå†™å…¥æ€»çº¿ |
| `NarrativeService` | éœ€æ”¹é€  | çº¿æ€§ tracking â†’ å®Œæˆåº¦ tracking |
| `IntentResolver` | æ‰©å±• | æ–°å¢ ACCEPT_QUEST / REPORT_QUEST æ„å›¾ |

### C5: å¼€æ”¾é—®é¢˜

| # | é—®é¢˜ | å€¾å‘ |
|---|------|------|
| Q1 | ä»»åŠ¡ç”Ÿæˆï¼šçº¯ LLM è¿˜æ˜¯æ¨¡æ¿+LLMï¼Ÿ | æ¨¡æ¿æä¾›ç»“æ„ï¼ŒLLM å¡«å……å™äº‹ |
| Q2 | ä»»åŠ¡æ•°é‡æ§åˆ¶ï¼Ÿ | æ¯ NPC â‰¤ 3 æ´»è·ƒï¼ŒåŒºåŸŸ â‰¤ 8 |
| Q3 | ä»»åŠ¡å¤±è´¥/è¿‡æœŸï¼Ÿ | game_time è¿‡æœŸï¼Œå¤±è´¥ä¸é™å®Œæˆåº¦ |
| Q4 | å¤šä¸»çº¿å¼§å¹¶è¡Œï¼Ÿ | ç¬¬ä¸€ç« å•å¼§ï¼Œåç»­å¯å¹¶è¡Œ |
| Q5 | ç°æœ‰ 8 äº‹ä»¶çš„å®šä½ï¼Ÿ | ä¿ç•™ä¸ºé‡Œç¨‹ç¢‘å‰§æƒ…è„šæœ¬ |
| Q6 | ä»»åŠ¡å®Œæˆåˆ¤å®šï¼Ÿ | æ··åˆï¼šç»“æ„åŒ–æ¡ä»¶ + LLM æ¨¡ç³Šåˆ¤å®š |

---

## äº”ã€Part D â€” å•†åº—ä¸äº¤æ˜“ç³»ç»Ÿ â¸ï¸ æŒ‚èµ·

### D0: ç°æœ‰åŸºç¡€ç›˜ç‚¹

| ç»„ä»¶ | çŠ¶æ€ | ä½ç½® |
|------|------|------|
| å•†åº—å­åœ°ç‚¹ | âœ… å·²å®šä¹‰ | `maps.json`: `blacksmith_workshop`ï¼ˆé“åŒ é“ºï¼‰ã€`tailor_shop`ï¼ˆè£ç¼åº—ï¼‰ |
| å•†åº—è¥ä¸šæ—¶é—´ | âœ… å·²å®ç° | `time_manager.py:175`: `is_shop_open()` â†’ 08:00-20:00 |
| å•†åº—è¿›å…¥ç®¡æ§ | âœ… å·²å®ç° | `world_runtime.py:288`: æ‰“çƒŠæ—¶æ‹’ç»è¿›å…¥ |
| å•†äºº NPC | âœ… å·²å®šä¹‰ | `forge_master`ã€`the_seamstress`ã€`black_market_merchant` |
| å•†äººæ´»åŠ¨æ—¶é—´è¡¨ | âœ… å·²å®ç° | `time_manager.py:199`: merchant æ—¥ç¨‹ï¼ˆå¼€åº—/å¿™ç¢Œ/æ‰“çƒŠ/å›å®¶ï¼‰ |
| ç‰©å“ä»·æ ¼ | âœ… å·²æœ‰ | `items.json` æ¯æ¡ `properties.price`ï¼ˆå¦‚ "75 gp"ã€"10 sp"ï¼‰ |
| InteractionType.SHOP | âœ… å·²æœ‰ | `area_navigator.py:28` |

### D1: å•†åº— = NPC å¯¹è¯çš„è´­ä¹°æ¨¡å¼ï¼ˆAD9ï¼‰

**è®¾è®¡ç†å¿µ**ï¼šå•†åº—ä¸æ˜¯ç‹¬ç«‹ç³»ç»Ÿï¼Œè€Œæ˜¯ NPC äº¤äº’çš„ä¸€ç§æ¨¡å¼ã€‚ç©å®¶ç‚¹å‡»é“åŒ  â†’ å‘èµ·å¯¹è¯ â†’ NPC Agent è¯†åˆ«è´­ä¹°æ„å›¾ â†’ å±•ç¤ºè´§æ¶ â†’ æ‰§è¡Œäº¤æ˜“ã€‚

```
ç©å®¶: "æˆ‘æƒ³ä¹°æŠŠå¥½ç‚¹çš„å‰‘"
forge_master (NPC Agent):
  â†’ æ„ŸçŸ¥ï¼šè‡ªå·±æ˜¯é“åŒ ï¼Œå½“å‰åœ¨é“åŒ é“ºï¼Œinventory æœ‰ [longsword, short_sword, ...]
  â†’ å›å¤ï¼š"å¥½çœ¼å…‰ï¼æˆ‘è¿™é‡Œæœ‰ä¸¤æŠŠä¸é”™çš„â€”â€”ç²¾é’¢é•¿å‰‘(50gp)å’ŒçŸ®äººçŸ­å‰‘(35gp)ã€‚ä½ çœ‹çœ‹ï¼Ÿ"
  â†’ è°ƒç”¨å·¥å…·ï¼šshow_shop_inventory(npc_id="forge_master", category="weapon")

ç©å®¶: "æˆ‘è¦é‚£æŠŠé•¿å‰‘"
forge_master:
  â†’ è°ƒç”¨å·¥å…·ï¼šsell_item(item_id="longsword", price=50, buyer="player")
  â†’ å¼•æ“æ‰§è¡Œï¼šplayer.gold -= 50, player.add_item("longsword")
  â†’ å›å¤ï¼š"æˆäº¤ï¼è¿™æŠŠç²¾é’¢é•¿å‰‘å¯æ˜¯æˆ‘çš„å¾—æ„ä¹‹ä½œï¼Œå¥½å¥½ä½¿ã€‚"
```

### D2: éœ€è¦å®ç°çš„ç»„ä»¶

**D2.1 NPC åº“å­˜/è´§æ¶ç³»ç»Ÿ**

æ¯ä¸ªå•†äºº NPC éœ€è¦ä¸€ä¸ªè´§æ¶ï¼ˆstockï¼‰ï¼Œå®šä¹‰å¯å”®ç‰©å“å’Œæ•°é‡ï¼š

```python
# æ–¹æ¡ˆï¼šåœ¨ NPC æ•°æ®æˆ– area_registry ä¸­å®šä¹‰
# maps.json çš„ sub_location å·²æœ‰ interaction_type: "shop"
# æ‰©å±•ï¼šæ·»åŠ  shop_stock å­—æ®µ

"blacksmith_workshop": {
    "interaction_type": "shop",
    "shop_stock": {
        "category": ["weapon", "armor", "shield"],
        "restock_interval": "daily",        # æ¯å¤©è¡¥è´§
        "price_modifier": 1.0,              # ä»·æ ¼å€ç‡ï¼ˆå¥½æ„Ÿåº¦å¯è°ƒæ•´ï¼‰
    }
}
```

è´§æ¶æ•°æ®æºï¼šç›´æ¥å¤ç”¨ `ItemRegistry`ï¼ŒæŒ‰ `category` è¿‡æ»¤ã€‚ä¸éœ€è¦ä¸ºæ¯ä¸ªå•†äººå•ç‹¬å®šä¹‰åº“å­˜â€”â€”ItemRegistry å°±æ˜¯"ä¸–ç•Œç‰©å“æ€»è¡¨"ï¼Œå•†äººæŒ‰ç±»å‹å”®å–å­é›†ã€‚

**D2.2 Agentic å·¥å…·ï¼š`buy_item` / `sell_item`**

æ–°å¢ä¸¤ä¸ª V4 Agentic å·¥å…·ï¼ˆç±»ä¼¼ç°æœ‰ `add_item` / `remove_item`ï¼‰ï¼š

```python
# buy_item: ç©å®¶ä»å•†äººå¤„è´­ä¹°
def buy_item(item_id: str, quantity: int = 1) -> str:
    """
    1. æ£€æŸ¥ï¼šç©å®¶æ˜¯å¦åœ¨å•†åº—å­åœ°ç‚¹ï¼Ÿå•†åº—æ˜¯å¦è¥ä¸šï¼Ÿ
    2. æ£€æŸ¥ï¼šItemRegistry ä¸­æ˜¯å¦æœ‰æ­¤ç‰©å“ï¼Ÿ
    3. æ£€æŸ¥ï¼šç©å®¶é‡‘å¸æ˜¯å¦è¶³å¤Ÿï¼Ÿ
    4. æ‰§è¡Œï¼šplayer.gold -= price * quantity
    5. æ‰§è¡Œï¼šplayer.add_item(item_id, item_name, quantity)
    6. è¿”å›ï¼šäº¤æ˜“ç»“æœ
    """

# sell_item: ç©å®¶å‘å•†äººå‡ºå”®
def sell_item(item_id: str, quantity: int = 1) -> str:
    """
    1. æ£€æŸ¥ï¼šç©å®¶èƒŒåŒ…ä¸­æ˜¯å¦æœ‰æ­¤ç‰©å“ï¼Ÿ
    2. è®¡ç®—ï¼šå”®ä»· = åŸä»· * sell_ratioï¼ˆé»˜è®¤ 0.5ï¼Œå³åŠä»·å›æ”¶ï¼‰
    3. æ‰§è¡Œï¼šplayer.remove_item(item_id, quantity)
    4. æ‰§è¡Œï¼šplayer.gold += sell_price * quantity
    5. è¿”å›ï¼šäº¤æ˜“ç»“æœ
    """
```

**D2.3 ä»·æ ¼è§£æ**

å½“å‰ `items.json` çš„ `price` å­—æ®µæ˜¯å­—ç¬¦ä¸²ï¼ˆ"75 gp"ã€"10 sp"ã€"500+ gp"ï¼‰ï¼Œéœ€è¦è§£æä¸ºæ•°å€¼ï¼š

```python
def parse_price(price_str: str) -> int:
    """å°†ä»·æ ¼å­—ç¬¦ä¸²è§£æä¸ºé“œå¸ï¼ˆæœ€å°å•ä½ï¼‰
    1 gp = 10 sp = 100 cp
    "75 gp" â†’ 7500
    "10 sp" â†’ 100
    "500+ gp" â†’ 50000ï¼ˆå¿½ç•¥ +ï¼‰
    """
```

### D3: å¥½æ„Ÿåº¦å½±å“ä»·æ ¼ï¼ˆåç»­ï¼‰

NPC å¥½æ„Ÿåº¦ï¼ˆdispositionï¼‰å·²æœ‰ `approval` å­—æ®µï¼ˆ-100~+100ï¼‰ï¼Œå¯åœ¨ D2 åŸºç¡€ä¸ŠåŠ ä»·æ ¼è°ƒæ•´ï¼š
```
price_modifier = 1.0 - (approval / 500)  # approval=+100 â†’ 0.8å€ï¼Œ-100 â†’ 1.2å€
```

---

## å…­ã€Part E â€” ç‰©å“ä¸ç»æµç³»ç»Ÿ â¸ï¸ æŒ‚èµ·

### E0: ç°æœ‰åŸºç¡€ç›˜ç‚¹

| ç»„ä»¶ | çŠ¶æ€ | ä½ç½® |
|------|------|------|
| PlayerCharacter.inventory | âœ… | `player_character.py:61`: `List[Dict]` |
| PlayerCharacter.equipment | âœ… | `player_character.py:60`: slot â†’ item_id |
| PlayerCharacter.gold | âœ… | `player_character.py:67`: `int` |
| ItemRegistry | âœ… | `item_registry.py`: 200+ ç‰©å“ï¼Œget/list/search |
| MCP èƒŒåŒ…å·¥å…· | âœ… | `inventory_tools.py`: get/add/remove/equip/unequip/use/lookup/search |
| V4 Agentic å·¥å…· | âœ… | `v4_agentic_tools.py:968`: add_item / remove_item |
| è£…å¤‡ AC è®¡ç®— | âœ… | `character_service.py:316`: é‡ç”²/ä¸­ç”²/è½»ç”²/ç›¾ç‰Œ/æ— ç”² |
| è§’è‰²åˆ›å»ºè£…å¤‡ | âœ… | `character_creation.json`: æŒ‰èŒä¸šåˆ†é…èµ·å§‹è£…å¤‡+é‡‘å¸ |
| ç‰©å“æ•ˆæœ(ITEM_EFFECTS) | âš ï¸ ä»…2ç§ | `rules.py:73`: healing_potion + greater_healing_potion |
| äº‹ä»¶ç‰©å“å¥–åŠ± | âš ï¸ éƒ¨åˆ† | `v4_agentic_tools.py:1681`: on_complete.add_items |
| æˆ˜æ–—æ‰è½ | âŒ æœªå®ç° | `combat_engine.py`: `items: list = []` + TODO |

### E1: ç‰©å“æ•ˆæœæ‰©å±•

å½“å‰ `ITEM_EFFECTS` ä»…æœ‰æ²»ç–—è¯æ°´ï¼Œä½† `items.json` ä¸­æœ‰å¤§é‡æ¶ˆè€—å“éœ€è¦æ•ˆæœå®šä¹‰ï¼š

```python
# éœ€è¦æ‰©å±• rules.py æˆ–æ–°å»º item_effects.py
ITEM_EFFECTS = {
    # æ²»ç–—ç±»
    "healing_potion":         {"type": "heal", "dice": "2d4+2"},
    "greater_healing_potion": {"type": "heal", "dice": "4d4+4"},
    "antidote":               {"type": "cure", "removes": ["poisoned"]},

    # å¢ç›Šç±»
    "stamina_potion":     {"type": "buff", "stat": "max_hp", "value": 10, "duration": "encounter"},
    "strength_elixir":    {"type": "buff", "stat": "str", "value": 2, "duration": "encounter"},

    # å·¥å…·ç±»
    "torch":          {"type": "utility", "effect": "light", "duration": "1 hour"},
    "rope":           {"type": "utility", "effect": "advantage_climbing"},
    "lockpick":       {"type": "utility", "effect": "advantage_lockpicking", "consumable": true},
}
```

**å®æ–½ç­–ç•¥**ï¼šé€æ­¥æ‰©å±•ï¼Œä¼˜å…ˆè¦†ç›–å•†åº—é‡Œä¼šå–çš„é«˜é¢‘ç‰©å“ï¼ˆè¯æ°´ â†’ è§£æ¯’å‰‚ â†’ å¢ç›Šè¯ â†’ å·¥å…·ï¼‰ã€‚

### E2: èƒŒåŒ… REST APIï¼ˆå‰ç«¯éœ€è¦ï¼‰

å½“å‰èƒŒåŒ…åªé€šè¿‡ MCP å·¥å…·æš´éœ²ç»™ LLMï¼Œå‰ç«¯çœ‹ä¸åˆ°ã€‚éœ€è¦ REST ç«¯ç‚¹ï¼š

```
GET  /api/game/{world_id}/sessions/{session_id}/inventory
  â†’ { inventory: [...], equipment: {...}, gold: int }

POST /api/game/{world_id}/sessions/{session_id}/inventory/equip
  â†’ { item_id, slot }

POST /api/game/{world_id}/sessions/{session_id}/inventory/use
  â†’ { item_id }
```

### E3: ç»æµå¾ªç¯é—­ç¯

**å½“å‰é‡‘å¸æµå‘**ï¼š

```
æ¥æºï¼ˆåªè¿›ï¼‰:
  âœ… è§’è‰²åˆ›å»ºåˆå§‹é‡‘å¸ï¼ˆ10-18 gpï¼‰
  âœ… æˆ˜æ–—èƒœåˆ©å¥–åŠ±ï¼ˆgoblin 5gp, orc 15gpï¼‰
  âœ… äº‹ä»¶å®Œæˆå¥–åŠ±ï¼ˆon_complete.add_goldï¼‰
  ğŸ”² ä»»åŠ¡å®Œæˆå¥–åŠ±ï¼ˆPart C ä»»åŠ¡æ± ï¼‰

å»å‘ï¼ˆåªå‡ºï¼‰:
  âŒ å•†åº—è´­ä¹° â†’ Part D
  âŒ æœåŠ¡æ¶ˆè´¹ï¼ˆä¿®ç†è£…å¤‡ã€æ—…åº—ä½å®¿ã€é©¬è½¦è´¹...ï¼‰
  âŒ NPC æ‰“èµ/è´¿èµ‚
  âœ… æˆ˜æ–—å¤±è´¥æƒ©ç½šï¼ˆå¤±å» 50% é‡‘å¸ï¼‰
```

**E3 ç›®æ ‡**ï¼šPart D å•†åº—ç³»ç»Ÿä¸Šçº¿åï¼Œé‡‘å¸æœ‰äº†å»å¤„ã€‚åç»­å¯åŠ ï¼š
- æ—…åº—ä¼‘æ¯æ¶ˆè´¹ï¼ˆä¸ Part G æ—¶é—´/ä¼‘æ¯æœºåˆ¶è”åŠ¨ï¼‰
- é“åŒ ä¿®ç†è´¹
- ä¿¡æ¯è´­ä¹°ï¼ˆé»‘å¸‚å•†äººå–æƒ…æŠ¥ï¼‰

---

## ä¸ƒã€Part F â€” è§’è‰²æˆé•¿ç³»ç»Ÿ â¸ï¸ æŒ‚èµ·

### F0: ç°æœ‰åŸºç¡€ç›˜ç‚¹

| ç»„ä»¶ | çŠ¶æ€ | ä½ç½® |
|------|------|------|
| XP è¿½è¸ª | âœ… | `player_character.py:51`: xp, xp_to_next_level |
| ç­‰çº§å­—æ®µ | âœ… | `player_character.py:50`: level |
| add_xp() | âœ… | `character_service.py:165`: åŠ  XP å¹¶æ£€æŸ¥å‡çº§ |
| å…­å¤§å±æ€§ | âœ… | `player_character.py:53`: abilities dict |
| æŠ€èƒ½ç†Ÿç»ƒåº¦ | âœ… | `player_character.py:55-58`: skill/save/weapon/armor proficiencies |
| ä¸“é•¿åˆ—è¡¨ | âœ… å­—æ®µå­˜åœ¨ | `player_character.py:63`: feats (List[str]) |
| èŒä¸šç‰¹æ€§åˆ—è¡¨ | âœ… å­—æ®µå­˜åœ¨ | `player_character.py:64`: class_features (List[str]) |
| ç§æ—ç‰¹æ€§åˆ—è¡¨ | âœ… å­—æ®µå­˜åœ¨ | `player_character.py:65`: racial_traits (List[str]) |

### F1: å‡çº§æœºåˆ¶ï¼ˆAD11ï¼‰

å½“å‰ `add_xp()` æ£€æŸ¥ XP é˜ˆå€¼ï¼Œä½†å‡çº§æ—¶**åªåŠ  level**ï¼Œä¸æ›´æ–°ä»»ä½•å±æ€§ã€‚

**éœ€è¦å®ç°çš„å‡çº§æ•ˆæœ**ï¼š

```python
def level_up(player: PlayerCharacter):
    player.level += 1
    player.proficiency_bonus = 2 + (player.level - 1) // 4  # D&D 5e æ ‡å‡†

    # HP å¢é•¿ = hit_die_avg + CON_mod
    hit_die = CLASS_HIT_DIE[player.character_class]  # fighter:d10, mage:d6...
    hp_gain = hit_die_avg(hit_die) + player.ability_modifier("con")
    player.max_hp += hp_gain
    player.current_hp += hp_gain  # å‡çº§æ—¶å›æ»¡

    # æ³•æœ¯ä½å¢é•¿ï¼ˆæ–½æ³•èŒä¸šï¼‰
    if player.character_class in SPELLCASTER_CLASSES:
        player.spell_slots = SPELL_SLOTS_BY_LEVEL[player.level]

    # æ¯ 4 çº§å±æ€§æå‡ï¼ˆ4/8/12/16/19ï¼‰
    if player.level in [4, 8, 12, 16, 19]:
        # æ ‡è®°å¾…åˆ†é…ï¼šå¼•æ“é€šçŸ¥å‰ç«¯é€‰æ‹© +2/+1+1 å±æ€§æå‡
        player.pending_asi = True
```

### F2: èŒä¸šç‰¹æ€§è§£é”

æ¯ä¸ªèŒä¸šåœ¨ç‰¹å®šç­‰çº§è§£é”ç‰¹æ€§ï¼Œå½“å‰ `class_features` å­—æ®µæ˜¯ç©ºåˆ—è¡¨ã€‚éœ€è¦æŒ‰ç­‰çº§è‡ªåŠ¨å¡«å……ï¼š

```
Fighter:
  Lv1: æ ¼æ–—é£æ ¼ã€äºŒæ¬¡å‘¼å¸
  Lv2: è¡ŒåŠ¨å¦‚æ¶Œ
  Lv3: æ­¦æœ¯èŒƒå‹ï¼ˆå­èŒä¸šï¼‰
  Lv5: é¢å¤–æ”»å‡»

Priest:
  Lv1: æ–½æ³•ã€ç¥åœ£é¢†åŸŸ
  Lv2: å¼•å¯¼ç¥åŠ›
  Lv5: æ¶ˆç­ä¸æ­»ç”Ÿç‰©(å‡çº§)
```

**å®æ–½ç­–ç•¥**ï¼šå…ˆç”¨é™æ€è¡¨ï¼ˆ`class_progression.py`ï¼‰ï¼Œåç»­å¯æ”¹ä¸ºæ•°æ®é©±åŠ¨ã€‚

### F3: ä¸“é•¿ç³»ç»Ÿ

å½“å‰ `feats` å­—æ®µå­˜åœ¨ä½†æ— æœºæ¢°æ•ˆæœã€‚D&D 5e ä¸“é•¿å½±å“æˆ˜æ–—å’Œæ¢ç´¢ï¼š

| ä¸“é•¿ | æ•ˆæœ | ä¼˜å…ˆçº§ |
|------|------|--------|
| è­¦è§‰ | å…ˆæ”» +5 | ä¸­ |
| åšéŸ§ | max_hp + level*1 | ä¸­ |
| å¹¸è¿ | æ¯é•¿ä¼‘ 3 æ¬¡é‡éª° | ä½ |
| é”çœ¼å°„æ‰‹ | è¿œç¨‹æ”»å‡» -5/+10 | ä½ï¼ˆæˆ˜æ–—ç³»ç»Ÿï¼‰ |

**å®æ–½ç­–ç•¥**ï¼šå‡çº§ç³»ç»Ÿå…ˆä¸å«ä¸“é•¿é€‰æ‹©ï¼Œåç»­å†åŠ ã€‚MVP åªåšå±æ€§æå‡ (ASI)ã€‚

---

## å…«ã€Part G â€” æ—¶é—´ç³»ç»Ÿæœºæ¢°åŒ– â¸ï¸ æŒ‚èµ·

### G0: ç°æœ‰åŸºç¡€ç›˜ç‚¹

| ç»„ä»¶ | çŠ¶æ€ | ä½ç½® |
|------|------|------|
| TimeManager | âœ… | `time_manager.py`: æ—¶é—´æ¨è¿›/æ—¶æ®µ/æ—¥æœŸ |
| æ—¶æ®µæšä¸¾ | âœ… | DAWN/DAY/DUSK/NIGHT |
| å•†åº—è¥ä¸šæ—¶é—´ | âœ… | `is_shop_open()` â†’ 08:00-20:00 |
| NPC æ´»åŠ¨è¡¨ | âœ… | merchant/guard/civilian/adventurer æ—¥ç¨‹ |
| update_time å·¥å…· | âœ… | V4 Agentic å·¥å…·ï¼ŒLLM æ‰‹åŠ¨è°ƒç”¨ |

### G1: é—®é¢˜

å½“å‰æ—¶é—´æ¨è¿›å®Œå…¨ä¾èµ– LLM è°ƒç”¨ `update_time` å·¥å…·ï¼š
- LLM å¯èƒ½é—å¿˜æ¨è¿› â†’ æ—¶é—´åœæ»
- æ¨è¿›ç²’åº¦ä¸ä¸€è‡´ï¼ˆæ—¶è·³å¤ªå¤šã€æ—¶ä¸åŠ¨ï¼‰
- æ—¶é—´æœ¬è´¨ä¸Šæ˜¯ä¸–ç•Œæœºæ¢°å±‚ï¼Œä¸åº”ç”±å™è¿°å±‚æ§åˆ¶

### G2: ç›®æ ‡è®¾è®¡

ç©å®¶æ“ä½œè‡ªåŠ¨æ¶ˆè€—æ—¶é—´ï¼ŒLLM ä»…ä¿ç•™"ç­‰å¾…/ä¼‘æ¯"ç­‰æ˜¾å¼æ—¶é—´è·³è·ƒï¼š

| æ“ä½œ | æ—¶é—´æ¶ˆè€— |
|------|----------|
| åœ°ç‚¹ç§»åŠ¨ï¼ˆarea â†’ areaï¼‰ | æ ¹æ®è·ç¦»ï¼š1-4 å°æ—¶ |
| å­åœ°ç‚¹åˆ‡æ¢ï¼ˆåŒ area å†…ï¼‰ | 5-15 åˆ†é’Ÿ |
| NPC å¯¹è¯ï¼ˆæ¯è½®ï¼‰ | 5 åˆ†é’Ÿ |
| æ¢ç´¢/æœç´¢ | 30 åˆ†é’Ÿ |
| ä¼‘æ¯ï¼ˆæ˜¾å¼ï¼‰ | LLM æ§åˆ¶ï¼šçŸ­ä¼‘1h / é•¿ä¼‘8h |
| å•†åº—äº¤æ˜“ | 15 åˆ†é’Ÿ |

### G3: å®æ–½æ–¹æ¡ˆ

åœ¨ `IntentExecutor` / `SessionRuntime` å±‚æ³¨å…¥æ—¶é—´æ¶ˆè€—ï¼šå„æ“ä½œæ‰§è¡Œåè‡ªåŠ¨è°ƒç”¨ `session.advance_time(minutes)`ï¼Œæ›¿ä»£ LLM ä¸»åŠ¨è°ƒ `update_time`ã€‚

`update_time` å·¥å…·ä¿ç•™ä½†é™å®šç”¨é€”ï¼šä»…ç”¨äº"ç­‰å¾…åˆ°æŸæ—¶é—´"å’Œ"ä¼‘æ¯"åœºæ™¯ã€‚

---

## ä¹ã€å®æ–½è·¯çº¿å›¾

> â¸ï¸ Phase 2-7 å…¨éƒ¨æŒ‚èµ·ï¼Œç­‰å¾…æ¶æ„é‡æ„ã€‚éœ€æ±‚ä¿ç•™ï¼Œå®æ–½æ–¹æ¡ˆåœ¨æ–°æ¶æ„ä¸‹é‡æ–°è®¾è®¡ã€‚

```
Phase 1: å¼•æ“é€šè·¯ âœ… å·²å®Œæˆï¼ˆ2026-02-20ï¼‰
  A1-A4  å­åœ°ç‚¹/HOSTSè¾¹/ç©ºé˜Ÿä¼/é™çº§æ—¥å¿— âœ…

Phase 2: å‰ç«¯åŸºç¡€é€‚é… â¸ï¸
  B1  NPC åˆ—è¡¨ API + å‰ç«¯å±•ç¤º
  B2  NPC ç›´æ¥äº¤äº’ç«¯ç‚¹
  B3  å­åœ°ç‚¹åˆ‡æ¢ UI
    â†“
Phase 3: å•†åº— & ç‰©å“ â¸ï¸
  D2.1  NPC è´§æ¶ç³»ç»Ÿï¼ˆshop_stock + ItemRegistry è¿‡æ»¤ï¼‰
  D2.2  buy_item / sell_item Agentic å·¥å…·
  D2.3  ä»·æ ¼è§£æï¼ˆ"75 gp" â†’ æ•°å€¼ï¼‰
  E1    ç‰©å“æ•ˆæœæ‰©å±•ï¼ˆè¯æ°´/è§£æ¯’å‰‚/å¢ç›Šï¼‰
  E2    èƒŒåŒ… REST API
    â†“
Phase 4: è§’è‰²æˆé•¿ â¸ï¸
  F1  å‡çº§æœºåˆ¶ï¼ˆHP/ç†Ÿç»ƒåº¦/æ³•æœ¯ä½/ASIï¼‰
  F2  èŒä¸šç‰¹æ€§è§£é”è¡¨
    â†“
Phase 5: æ—¶é—´æœºæ¢°åŒ– â¸ï¸
  G2  æ“ä½œè‡ªåŠ¨æ¶ˆè€—æ—¶é—´
  G3  update_time å·¥å…·é™å®šç”¨é€”
    â†“
Phase 6: ä»»åŠ¡æ±  MVP â¸ï¸
  C2  StorylineArc + Quest æ•°æ®æ¨¡å‹
  C3  NPC Agent ä»»åŠ¡ç”Ÿæˆï¼ˆå• NPC å…ˆéªŒè¯ï¼‰
  C4  å®Œæˆåº¦è¿½è¸ª + é‡Œç¨‹ç¢‘è§¦å‘
    â†“
Phase 7: å…¨é¢æ‰“ç£¨ â¸ï¸
  D3  å¥½æ„Ÿåº¦å½±å“ä»·æ ¼
  E3  ç»æµå¾ªç¯è°ƒä¼˜
  B4  æ€»çº¿å¯è§†åŒ–
  F3  ä¸“é•¿ç³»ç»Ÿ
  å…¨é¢æµ‹è¯• + è°ƒä¼˜
```

---

## åã€å…³é”®ä»£ç ä½ç½®é€ŸæŸ¥

| ç³»ç»Ÿ | æ ¸å¿ƒæ–‡ä»¶ | è¯´æ˜ |
|------|---------|------|
| ç‰©å“æ¨¡å‹ | `app/models/player_character.py` | inventory, equipment, gold |
| ç‰©å“æ³¨å†Œè¡¨ | `app/services/item_registry.py` | get_item, list_items, search_items |
| MCP èƒŒåŒ…å·¥å…· | `app/mcp/tools/inventory_tools.py` | 8 ä¸ªå·¥å…· |
| V4 ç‰©å“å·¥å…· | `app/services/admin/v4_agentic_tools.py:968` | add_item, remove_item |
| è£…å¤‡æœåŠ¡ | `app/services/character_service.py` | equip/unequip/_recalculate_ac |
| ç‰©å“æ•ˆæœ | `app/rules.py:73` | ITEM_EFFECTSï¼ˆä»… 2 ç§ï¼‰ |
| ç‰©å“ä½¿ç”¨ | `app/world/intent_executor.py:735` | USE_ITEM æ„å›¾æ‰§è¡Œ |
| æ—¶é—´ç®¡ç† | `app/services/time_manager.py` | TimeManager, is_shop_open |
| åŒºåŸŸå¯¼èˆª | `app/services/area_navigator.py` | InteractionType.SHOP |
| ä¸–ç•Œè¿è¡Œæ—¶ | `app/services/admin/world_runtime.py:288` | å•†åº—è¿›å…¥ç®¡æ§ |
| è§’è‰²åˆ›å»º | `data/goblin_slayer/structured/character_creation.json` | èŒä¸š/ç§æ—/èµ·å§‹è£…å¤‡ |
| ç‰©å“æ•°æ® | `data/goblin_slayer/structured_new/items.json` | 200+ ç‰©å“å®šä¹‰ |
| æŠ€èƒ½æ•°æ® | `data/goblin_slayer/structured_new/skills.json` | 1400+ æŠ€èƒ½/æ³•æœ¯ |
| æ€ªç‰©æ•°æ® | `data/goblin_slayer/structured_new/monsters.json` | 6000+ æ€ªç‰©ï¼ˆå« lootï¼‰ |
| åœ°å›¾æ•°æ® | `data/goblin_slayer/structured_new/maps.json` | å•†åº—å­åœ°ç‚¹å®šä¹‰ |

---

## åä¸€ã€å˜æ›´æ—¥å¿—

| æ—¥æœŸ | æ“ä½œ |
|------|------|
| 2026-02-20 | ä»ã€Œæ–°ç³»ç»Ÿä¸Šçº¿é˜»å¡é—®é¢˜æ¸…å•ã€åˆ›å»ºï¼ŒåŒ…å« Part A/B/C |
| 2026-02-20 | Part A å…¨éƒ¨å®Œæˆï¼ˆA1-A4ï¼‰ï¼Œ222 æµ‹è¯•é€šè¿‡ã€‚A3 è°ƒæ•´ä¸ºç©ºé˜Ÿä¼ + é‚€è¯·æœºåˆ¶ |
| 2026-02-20 | å‡æ ¼ä¸ºã€Œä¸»ä¸–ç•Œç³»ç»Ÿå»ºè®¾è·¯çº¿å›¾ã€ã€‚å…¨é¢ç›˜ç‚¹åæ–°å¢ Part Dï¼ˆå•†åº—äº¤æ˜“ï¼‰ã€Part Eï¼ˆç‰©å“ç»æµï¼‰ã€Part Fï¼ˆè§’è‰²æˆé•¿ï¼‰ã€Part Gï¼ˆæ—¶é—´æœºæ¢°åŒ–ï¼‰ã€‚æˆ˜æ–—ç³»ç»Ÿç‹¬ç«‹åˆ° `æˆ˜æ–—ç³»ç»Ÿé‡æ„è®¡åˆ’.md` |
| 2026-02-20 | **Part B-G å…¨éƒ¨æŒ‚èµ·**ã€‚å¯åŠ¨æ¶æ„çº§é‡æ„ï¼šå°†æ¸¸æˆä¸–ç•Œç³»ç»Ÿæ•´ä½“åŒ…è£…ä¸ºç»Ÿä¸€ MCP æœåŠ¡ + æŠ½è±¡æœåŠ¡å±‚ï¼ŒAgent/ç©å®¶é€šè¿‡ç»Ÿä¸€æ¥å£ä¸ä¸–ç•Œäº¤äº’ã€‚Part B-G éœ€æ±‚ä¿ç•™ï¼Œå®æ–½æ–¹æ¡ˆåœ¨æ–°æ¶æ„ä¸‹é‡æ–°è®¾è®¡ |
