# 前端改进计划

> 状态：📝 想法收集阶段，暂不实施

---

## 1. 阶段 4 功能适配

### 1.1 NPC 对话交互

- 进入区域后展示**可交互对象列表**（NPC、物品、地点）
- 点击 NPC → 打开对话界面
- 对话界面包含：
  - NPC 对话气泡
  - **4 个可选对话选项**（GM 生成）+ 自由输入框
  - 队友插嘴区域（如有）
  - GM 氛围描述（如有）
- 结束对话按钮 / 导航离开自动结束

### 1.2 场景总线可视化

- SceneBus 成员列表（谁在"场景"中）
- 对话历史流（按 BusEntry 类型区分样式）

---

## 2. 场景图像生成

- 切换场景（区域/子地点）后，GM 可调用图像生成模型生成**场景插图**
- 生成的图片作为场景背景或头部插图加载到界面
- 图片可缓存/复用（同一场景不重复生成）

---

## 3. 角色头像系统

- NPC 和队友需要**头像容器**
- 头像生成：
  - 首次遇到角色时根据角色描述生成头像
  - 生成后**长期存储**（Firestore 或 Cloud Storage）
  - 后续直接复用，不重复生成
- 头像展示：
  - 对话气泡旁显示
  - 队伍面板中显示
  - NPC 交互列表中显示

---

## 4. 状态面板改进

- HP/XP/金币实时更新（通过 SSE state_delta 事件）
- 背包结构化展示（待 InventoryManager 实现后）
- 游戏时间显示（回合时间系统上线后）

---

## 变更日志

| 日期 | 操作 |
|------|------|
| 2026-02-21 | 创建：记录前端改进想法（场景图像 + 头像系统 + 对话 UI + 状态面板） |
